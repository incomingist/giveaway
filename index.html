<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Giveaway Entry</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
:root{
  --bg0:#070a12;
  --bg1:#09122a;
  --glass2: rgba(255,255,255,.045);
  --txt:#ffffff;
  --muted: rgba(255,255,255,.72);
  --glow: rgba(13,110,253,.28);
  --good: rgba(25,135,84,1);
}

body{
  min-height:100vh;
  background:
    radial-gradient(1200px 800px at 20% 10%, rgba(13,110,253,.22), transparent 55%),
    radial-gradient(1000px 700px at 90% 30%, rgba(25,135,84,.16), transparent 60%),
    linear-gradient(180deg, var(--bg1), var(--bg0));
  color: var(--txt);
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif;
}

body, .card, label, p, span, div, h1,h2,h3,h4,h5,h6, small{ color:#fff !important; }
.small-muted{ color: var(--muted) !important; }

.topbar{
  display:flex; justify-content:space-between; align-items:center;
  margin-bottom:12px;
}

.brand{ display:flex; justify-content:center; margin: 10px 0 18px; }
.brand img{
  height:108px;
  filter: drop-shadow(0 18px 22px rgba(0,0,0,.45));
  border-radius:14px;
}

.card{
  background: var(--glass2);
  border: 1px solid rgba(255,255,255,.10);
  border-radius:22px;
  backdrop-filter: blur(14px);
  box-shadow:0 22px 70px rgba(0,0,0,.45);
}

.form-control, .input-group-text{
  background: rgba(255,255,255,.07) !important;
  border-color: rgba(255,255,255,.14) !important;
  color:#fff !important;
}
.form-control::placeholder{ color: rgba(255,255,255,.55) !important; }
.form-control:focus{
  border-color: rgba(13,110,253,.55) !important;
  box-shadow: 0 0 0 .22rem var(--glow) !important;
}

.btn{ border-radius:14px; }

.tick-wrap{
  width:132px; height:132px; border-radius:999px;
  display:grid; place-items:center;
  background: rgba(25,135,84,.12);
  border:1px solid rgba(25,135,84,.38);
  margin-inline:auto;
}

svg.tick{ width:92px; height:92px; }
.tick circle{
  stroke: var(--good); stroke-width:6; fill:none;
  stroke-dasharray:260; stroke-dashoffset:260;
  animation:drawCircle .7s ease forwards;
}
.tick path{
  stroke: var(--good); stroke-width:7; fill:none;
  stroke-linecap:round; stroke-linejoin:round;
  stroke-dasharray:90; stroke-dashoffset:90;
  animation:drawTick .55s .55s ease forwards;
}
@keyframes drawCircle { to { stroke-dashoffset:0; } }
@keyframes drawTick { to { stroke-dashoffset:0; } }

.code-box{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  letter-spacing:.9px;
  background: rgba(255,255,255,.07);
  border:1px solid rgba(255,255,255,.16);
  border-radius:14px;
  padding:12px 14px;
  color:#fff !important;
  font-weight:700;
}

.hidden{ display:none !important; }

/* Dark dropdown menu (Bootstrap) */
.dropdown-menu{
  background: #0b1020;
  border: 1px solid rgba(255,255,255,.14);
  border-radius: 14px;
  box-shadow: 0 18px 60px rgba(0,0,0,.55);
}
.dropdown-item{
  color:#fff;
}
.dropdown-item:hover, .dropdown-item:focus{
  background: rgba(255,255,255,.08);
  color:#fff;
}
.dropdown-divider{
  border-top-color: rgba(255,255,255,.10);
}
</style>
</head>

<body class="d-flex align-items-center">
<main class="container py-5" style="max-width:800px;">

<div class="topbar">
  <div class="small-muted" data-i18n="powered">Giveaway</div>
  <div class="btn-group">
    <button id="langEN" class="btn btn-sm btn-outline-light">EN</button>
    <button id="langRU" class="btn btn-sm btn-outline-light">RU</button>
  </div>
</div>

<div class="brand">
  <img src="logo.png" alt="Company Logo">
</div>

<section id="formPage" class="card p-4 p-md-5">
  <form id="joinForm" novalidate autocomplete="off">

    <div class="mb-3">
      <label class="form-label" data-i18n="fullNameLabel">Full Name</label>
      <input id="fullName" name="fullName" autocomplete="off"
             class="form-control form-control-lg"
             data-i18n-ph="fullNamePh"
             placeholder="e.g., John Smith" required minlength="3"/>
      <div class="invalid-feedback" data-i18n="nameInvalid"></div>
    </div>

    <div class="mb-3">
      <label class="form-label" data-i18n="phoneLabel">Phone Number</label>

      <div class="input-group input-group-lg">
        <!-- Custom country picker -->
        <div class="dropdown">
          <button id="ccBtn" class="btn btn-outline-light dropdown-toggle" type="button"
                  data-bs-toggle="dropdown" aria-expanded="false"
                  style="min-width: 190px; text-align:left;">
            TR +90
          </button>
          <ul id="ccMenu" class="dropdown-menu" style="min-width: 240px;">
            <!-- injected by JS -->
          </ul>
        </div>

        <span class="input-group-text" id="ccPrefix">+90</span>

        <input id="phone" name="phone" autocomplete="off"
               class="form-control"
               data-i18n-ph="phonePh"
               placeholder="digits only" required />
        <div class="invalid-feedback" data-i18n="phoneInvalid"></div>
      </div>

      <div class="small-muted mt-2" data-i18n="phoneHelp">
        Choose country code and enter digits.
      </div>
    </div>

    <div class="mb-4">
      <label class="form-label" data-i18n="hotelLabel">Hotel Name</label>
      <input id="hotel" name="hotel" autocomplete="off"
             class="form-control form-control-lg"
             data-i18n-ph="hotelPh"
             placeholder="e.g., Hilton Istanbul" required minlength="2"/>
      <div class="invalid-feedback" data-i18n="hotelInvalid"></div>
    </div>

    <button id="submitBtn" class="btn btn-primary btn-lg w-100 fw-semibold"
            type="submit" data-i18n="submitBtn">Submit</button>
  </form>
</section>

<section id="successPage" class="card p-4 p-md-5 hidden">
  <div class="text-center">
    <div class="tick-wrap mb-3">
      <svg class="tick" viewBox="0 0 100 100">
        <circle cx="50" cy="50" r="41"></circle>
        <path d="M28 52 L44 67 L73 36"></path>
      </svg>
    </div>

    <h2 data-i18n="approvedTitle">Approved</h2>
    <div class="small-muted mb-3" data-i18n="approvedSub">Your entry has been received.</div>

    <div class="text-start small-muted mb-2" data-i18n="kuraIdLabel">Giveaway ID</div>
    <div class="d-flex gap-2">
      <div id="kuraId" class="code-box flex-grow-1">â€”</div>
      <button id="copyBtn" class="btn btn-success" data-i18n="copyBtn">Copy</button>
    </div>

    <div id="copyHint" class="small-muted mt-2" style="min-height:18px;"></div>

    <button id="newBtn" class="btn btn-outline-light mt-4 w-100"
            data-i18n="newBtn">New Entry</button>
  </div>
</section>

</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
/* ================= CONFIG ================= */
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxCRsVqAWqY5Im1eaWjXYA9xnoYa1eF0afANBHUWlSWBfTGUyp2zj86uCSAKFRytsx2/exec";

/* If emojis still not visible on some devices, keep this false */
const useEmoji = true;

const countries = [
  { code:"TR", dial:"+90",  flag:"ðŸ‡¹ðŸ‡·" },
  { code:"UZ", dial:"+998", flag:"ðŸ‡ºðŸ‡¿" },
  { code:"RU", dial:"+7",   flag:"ðŸ‡·ðŸ‡º" },
  { code:"KG", dial:"+996", flag:"ðŸ‡°ðŸ‡¬" },
  { code:"TJ", dial:"+992", flag:"ðŸ‡¹ðŸ‡¯" },
  { code:"TM", dial:"+993", flag:"ðŸ‡¹ðŸ‡²" },
  { code:"AZ", dial:"+994", flag:"ðŸ‡¦ðŸ‡¿" },
  { code:"GE", dial:"+995", flag:"ðŸ‡¬ðŸ‡ª" },
  { code:"UA", dial:"+380", flag:"ðŸ‡ºðŸ‡¦" },
  { code:"BY", dial:"+375", flag:"ðŸ‡§ðŸ‡¾" }
];

let selected = countries[0];

/* ================= i18n ================= */
const i18n = {
  en:{
    powered:"Giveaway",
    fullNameLabel:"Full Name",
    fullNamePh:"e.g., John Smith",
    phoneLabel:"Phone Number",
    phonePh:"digits only",
    phoneHelp:"Choose country code and enter digits.",
    hotelLabel:"Hotel Name",
    hotelPh:"e.g., Hilton Istanbul",
    submitBtn:"Submit",
    approvedTitle:"Approved",
    approvedSub:"Your entry has been received.",
    kuraIdLabel:"Giveaway ID",
    copyBtn:"Copy",
    newBtn:"New Entry",
    nameInvalid:"Please enter your full name.",
    phoneInvalid:"Please enter a valid phone number.",
    hotelInvalid:"Please enter your hotel name.",
    copied:"Copied âœ…",
    copyFail:"Copy failed."
  },
  ru:{
    powered:"Ð Ð¾Ð·Ñ‹Ð³Ñ€Ñ‹Ñˆ",
    fullNameLabel:"Ð˜Ð¼Ñ Ð¸ Ñ„Ð°Ð¼Ð¸Ð»Ð¸Ñ",
    fullNamePh:"Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: John Smith",
    phoneLabel:"ÐÐ¾Ð¼ÐµÑ€ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð°",
    phonePh:"Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ†Ð¸Ñ„Ñ€Ñ‹",
    phoneHelp:"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÐºÐ¾Ð´ ÑÑ‚Ñ€Ð°Ð½Ñ‹ Ð¸ Ð²Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ñ†Ð¸Ñ„Ñ€Ñ‹.",
    hotelLabel:"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ‚ÐµÐ»Ñ",
    hotelPh:"Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: Hilton Istanbul",
    submitBtn:"ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ",
    approvedTitle:"ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¾",
    approvedSub:"Ð’Ð°ÑˆÐ° Ð·Ð°ÑÐ²ÐºÐ° Ð¿Ñ€Ð¸Ð½ÑÑ‚Ð°.",
    kuraIdLabel:"ID Ñ€Ð¾Ð·Ñ‹Ð³Ñ€Ñ‹ÑˆÐ°",
    copyBtn:"ÐšÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ",
    newBtn:"ÐÐ¾Ð²Ð°Ñ Ð·Ð°ÑÐ²ÐºÐ°",
    nameInvalid:"Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¸Ð¼Ñ Ð¸ Ñ„Ð°Ð¼Ð¸Ð»Ð¸ÑŽ.",
    phoneInvalid:"Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ñ‹Ð¹ Ð½Ð¾Ð¼ÐµÑ€.",
    hotelInvalid:"Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ‚ÐµÐ»Ñ.",
    copied:"Ð¡ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾ âœ…",
    copyFail:"ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ ÑÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ."
  }
};

let lang="en";
function setLang(l){
  lang=l;
  document.querySelectorAll("[data-i18n]").forEach(el=>{
    const k=el.dataset.i18n;
    if(i18n[lang][k]) el.textContent=i18n[lang][k];
  });
  document.querySelectorAll("[data-i18n-ph]").forEach(el=>{
    const k=el.dataset.i18nPh;
    if(i18n[lang][k]) el.placeholder=i18n[lang][k];
  });

  const enBtn=document.getElementById("langEN");
  const ruBtn=document.getElementById("langRU");
  enBtn.classList.toggle("btn-light", lang==="en");
  enBtn.classList.toggle("btn-outline-light", lang!=="en");
  ruBtn.classList.toggle("btn-light", lang==="ru");
  ruBtn.classList.toggle("btn-outline-light", lang!=="ru");
  enBtn.classList.toggle("text-dark", lang==="en");
  ruBtn.classList.toggle("text-dark", lang==="ru");
}
document.getElementById("langEN").onclick=()=>setLang("en");
document.getElementById("langRU").onclick=()=>setLang("ru");
setLang("en");

/* ================= Country picker ================= */
const ccBtn = document.getElementById("ccBtn");
const ccMenu = document.getElementById("ccMenu");
const ccPrefix = document.getElementById("ccPrefix");

function labelFor(c){
  return useEmoji ? `${c.flag} ${c.code} ${c.dial}` : `${c.code} ${c.dial}`;
}
function renderMenu(){
  ccMenu.innerHTML = "";
  countries.forEach(c=>{
    const li = document.createElement("li");
    const a = document.createElement("button");
    a.type="button";
    a.className="dropdown-item";
    a.textContent = labelFor(c);
    a.onclick = ()=>{
      selected = c;
      ccBtn.textContent = labelFor(c);
      ccPrefix.textContent = c.dial;
    };
    li.appendChild(a);
    ccMenu.appendChild(li);
  });
}
renderMenu();
ccBtn.textContent = labelFor(selected);
ccPrefix.textContent = selected.dial;

/* ================= App ================= */
const formPage=document.getElementById("formPage");
const successPage=document.getElementById("successPage");
const form=document.getElementById("joinForm");
const fullName=document.getElementById("fullName");
const phone=document.getElementById("phone");
const hotel=document.getElementById("hotel");
const kuraIdEl=document.getElementById("kuraId");
const copyHint=document.getElementById("copyHint");

function normalizeDigits(v){ return (v||"").replace(/[^\d]/g,""); }
function isValidPhone(d){ return d.length>=6 && d.length<=15; }

function makeKuraId(){
  const a="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";
  const r=n=>Array.from({length:n},()=>a[Math.floor(Math.random()*a.length)]).join("");
  return `KURA-${new Date().getFullYear()}-${r(4)}-${r(4)}`;
}

function showSuccess(){
  formPage.classList.add("hidden");
  successPage.classList.remove("hidden");
  // restart tick animation
  const svg = successPage.querySelector("svg.tick");
  const clone = svg.cloneNode(true);
  svg.parentNode.replaceChild(clone, svg);
}

form.addEventListener("submit",e=>{
  e.preventDefault();
  copyHint.textContent = "";

  const invalids = form.querySelectorAll(".invalid-feedback");
  invalids[0].textContent = i18n[lang].nameInvalid;
  invalids[1].textContent = i18n[lang].phoneInvalid;
  invalids[2].textContent = i18n[lang].hotelInvalid;

  const nameVal = fullName.value.trim();
  const phoneDigits = normalizeDigits(phone.value);
  const hotelVal = hotel.value.trim();

  let ok=true;
  if(nameVal.length<3){ fullName.classList.add("is-invalid"); ok=false; } else fullName.classList.remove("is-invalid");
  if(!isValidPhone(phoneDigits)){ phone.classList.add("is-invalid"); ok=false; } else phone.classList.remove("is-invalid");
  if(hotelVal.length<2){ hotel.classList.add("is-invalid"); ok=false; } else hotel.classList.remove("is-invalid");
  if(!ok) return;

  const kuraId = makeKuraId();
  kuraIdEl.textContent = kuraId;

  // UI immediately
  showSuccess();

  // send to Sheets (no-cors)
  fetch(WEB_APP_URL,{
    method:"POST",
    mode:"no-cors",
    headers:{ "Content-Type":"text/plain;charset=utf-8" },
    body: JSON.stringify({
      name: nameVal,
      phone: phoneDigits,
      countryCode: selected.dial,
      hotel: hotelVal,
      kuraId: kuraId,
      lang: lang
    })
  }).catch(()=>{});
});

document.getElementById("copyBtn").onclick = async ()=>{
  try{
    await navigator.clipboard.writeText(kuraIdEl.textContent);
    copyHint.textContent = i18n[lang].copied;
  }catch{
    copyHint.textContent = i18n[lang].copyFail;
  }
  setTimeout(()=>copyHint.textContent="", 1500);
};

document.getElementById("newBtn").onclick = ()=>{
  form.reset();
  successPage.classList.add("hidden");
  formPage.classList.remove("hidden");
  fullName.focus();
};
</script>
</body>
</html>

<!-- redeploy -->

